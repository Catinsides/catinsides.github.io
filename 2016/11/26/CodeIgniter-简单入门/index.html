<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> CodeIgniter 简单入门 · catinsides.github.io</title><meta name="description" content="CodeIgniter 简单入门 - catinsides"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://catinsides.github.io/atom.xml" title="catinsides.github.io"><meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="catinsides.github.io" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/Catinsides" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">CodeIgniter 简单入门</h1><div class="post-info">2016年11月26日</div><div class="post-content"><blockquote>
<p>CodeIgniter 是一套给 PHP 网站开发者使用的应用程序开发框架和工具包。 它的目标是让你能够更快速的开发，它提供了日常任务中所需的大量类库， 以及简单的接口和逻辑结构。通过减少代码量，CodeIgniter 让你更加专注于你的创造性工作。</p>
</blockquote>
<p>本文介绍该框架（简称CI）的基本功能，方便自己查阅和回顾。<br>闲话少叙，下面开始:)</p>
<h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><p>测试环境建议使用wamp或lamp，下载后安装即可。<br>从CI官网下载压缩包，解压到wamp(lamp)目录下的www文件夹内，<br>在浏览器地址栏输入 <a target="_blank" rel="noopener" href="http://localhost/">http://localhost</a> ，即可看到欢迎界面。</p>
<h3 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h3><p>路由配置文件routes.php在框架根目录下application&#x2F;config文件夹内，打开后看到一堆注释和保留语句。注释部分算是一部分教程，方便理解框架内容。<br>保留语句是路由名称数组，左面是匹配规则，右面是对应的控制器类。<br>仅保留这一条规则，其他规则注释掉。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$route</span>[<span class="string">&#x27;default_controller&#x27;</span>] = <span class="string">&#x27;welcome&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>这行代码的含义是，当打开 <a target="_blank" rel="noopener" href="http://localhost/">http://localhost</a> 时，默认使用Welcome控制器。<br>噫，这里怎么只有控制器名没有方法名呢？<br>这时打开application&#x2F;controller下的Welcome.php，会发现里面有一个index()方法，通过上面的注释可以了解到，访问<br><a target="_blank" rel="noopener" href="http://localhost/index.php/welcome">http://localhost/index.php/welcome</a><br>或<br><a target="_blank" rel="noopener" href="http://localhost/index.php/welcome/index">http://localhost/index.php/welcome/index</a><br>都会匹配到index()方法。<br>即当url中没有指明方法名称时，CI会自动寻找当前控制器类下的index()方法执行。</p>
<p>好了，上面都是官方的范例，现在轮到自己动手了。<br>情景设定为，从数据库中获取所有的优惠码显示在页面中。<br>新建路由规则，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$route</span>[<span class="string">&#x27;codes&#x27;</span>] = <span class="string">&#x27;main/get&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>访问 <a target="_blank" rel="noopener" href="http://localhost/index.php/codes">http://localhost/index.php/codes</a> 时，即可使用Main控制类下的get()方法。</p>
<p>路由规则也可以使用正则限定参数，例</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$route</span>[<span class="string">&#x27;codes/([a-z]+)/(\d+)&#x27;</span>] = <span class="string">&#x27;main/$1/$2&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>访问 <a target="_blank" rel="noopener" href="http://localhost/index.php/codes/get/1">http://localhost/index.php/codes/get/1</a> 时，会定向到main类下的get()方法，多余的url参数会传入到函数中。</p>
<h3 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h3><p>在目录application&#x2F;controller下，新建文件Main.php。<br>控制器类文件名可根据编程规范命名，这里为了方便仅采用了首字母大写的规则。<br>打开文件，键入代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Main</span> <span class="keyword">extends</span> <span class="title">CI_Controller</span> </span>&#123;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>因为要从数据库中获取信息，所以可以把读取模型的代码写入到构造方法中，减少后面的代码量。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">parent</span>::<span class="title function_ invoke__">__construct</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;load-&gt;<span class="title function_ invoke__">model</span>(<span class="string">&#x27;coupon_model&#x27;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>在get()方法中，直接使用模型类中的方法即可。<br>同时，把将要渲染模板的代码写入方法中，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$data</span>[<span class="string">&#x27;codes&#x27;</span>] = <span class="variable language_">$this</span>-&gt;coupon-&gt;<span class="title function_ invoke__">get_codes</span>();</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;load-&gt;<span class="title function_ invoke__">view</span>(<span class="string">&#x27;templates/header&#x27;</span>);</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;load-&gt;<span class="title function_ invoke__">view</span>(<span class="string">&#x27;pages/content&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;load-&gt;<span class="title function_ invoke__">view</span>(<span class="string">&#x27;templates/footer&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的view()方法会在<b>模板</b>章节介绍。</p>
<h3 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h3><p>数据库配置文件在目录application&#x2F;config下，<br>打开database.php可以看相关配置参数，根据实际情况填写即可。<br>配置完成后，在目录application&#x2F;models下，新建模型类文件Coupon_model.php,<br>打开文件输入以下代码即可完成配置，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Coupon_model</span> <span class="keyword">extends</span> <span class="title">CI_Model</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="variable language_">$this</span>-&gt;load-&gt;<span class="title function_ invoke__">database</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_codes</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="variable">$query</span> = <span class="variable language_">$this</span>-&gt;db-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">         <span class="keyword">return</span> <span class="variable">$query</span>-&gt;<span class="title function_ invoke__">result_array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>返回数据格式为数组。<br>这里用到的数据库信息与THINKPHP快速入门中一致。<br>这样，框架的模型配置已经完成了。</p>
<h3 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h3><p>这里介绍第三节提到的渲染模板。根据代码可以看出view()方法接收了两个参数，其中一个是模板文件的路径，另一个则是传入的变量。<br>模板文件在目录application&#x2F;views下，其中有官方模板可以借用。<br>新建两个文件夹pages和templates，与代码相对应。<br>顾名思义，templates是模板，可以将html通用代码分为header.html和footer.html两个文件，如<code>&lt;body&gt;</code>标签以上的部分写到header内，<code>&lt;/body&gt;</code>以下的部分写到footer内。引用时不需要写后缀名。<br>在pages文件夹内创建content.html，输入代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;h2&gt;这里是优惠码:&lt;/h2&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">foreach</span> (<span class="variable">$data</span> <span class="keyword">as</span> <span class="variable">$date_item</span>):<span class="meta">?&gt;</span></span><br><span class="line">    &lt;li&gt;<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$date_item</span>[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;:&quot;</span>.<span class="variable">$date_item</span>[<span class="string">&#x27;code&#x27;</span>]; <span class="meta">?&gt;</span>&lt;/li&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">endforeach</span>; <span class="meta">?&gt;</span></span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>
<p>这样的代码很是让人头疼。CI提供了模板解析类，使用更优美的模板语言渲染模板。当然这部分内容不在本文的范围内，具体内容可以参考官方文档。<br>当模板渲染时，会按照view()的顺序依次渲染。</p>
<p>现在，在浏览器地址栏输入  <a target="_blank" rel="noopener" href="http://localhost/index.php/codes">http://localhost/index.php/codes</a> ，会看到从数据库中获取的优惠码信息。</p>
<p>0:SUFFLzS<br>1:hZxakCl<br>2:xD2gz0N<br>3:6WwLt7U<br>4:xLSxY1n<br>5:bn422Ka<br>6:55BaQ0C<br>7:Ui1Jc8P</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>　　CodeIgniter的开发遵循了MVC的设计模式，这种将逻辑层与表现层分离的软件方法，让开发人员更专注于自己所属的工作，同时代码的维护也方便了很多。<br>　　个人非常喜欢CI框架，不仅是其简单自由高效的特性，更因为其语法风格。开发时配置明确，思路清晰，总之写起来很爽。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2016/12/19/SCRAPY-%E7%AE%80%E5%8D%95%E5%85%A5%E9%97%A8/" class="prev">上一篇</a><a href="/2016/11/26/Threejs%E8%AF%BB%E5%8F%96STL%E6%96%87%E4%BB%B6/" class="next">下一篇</a></div><div class="copyright"><p>© 2016 - 2024 <a href="https://catinsides.github.io">catinsides</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>